import { createServer } from 'vite';
import { analytics, error as kitError } from '@shopify/cli-kit';
async function dev({ commandConfig, directory, force, host, open }) {
    try {
        const server = await createServer({
            root: directory,
            server: {
                open,
                force,
                host,
            },
        });
        await server.listen();
        server.printUrls();
        server.config.logger.info('');
        await analytics.reportEvent({ config: commandConfig });
        await closeEvent(server);
        // eslint-disable-next-line @typescript-eslint/no-explicit-any
    }
    catch (error) {
        const abortError = new kitError.Abort(error.message);
        abortError.stack = error.stack;
        throw abortError;
    }
}
function closeEvent(server) {
    return new Promise((resolve) => {
        server.ws.on('close', () => {
            return resolve();
        });
    });
}
export default dev;
//# sourceMappingURL=dev.js.map