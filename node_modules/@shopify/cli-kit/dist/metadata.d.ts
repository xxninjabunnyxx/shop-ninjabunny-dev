import { AnyJson } from './json.js';
import { PickByPrefix } from './typing/pick-by-prefix.js';
declare type ProvideMetadata<T> = () => Partial<T> | Promise<Partial<T>>;
declare type MetadataErrorHandling = 'auto' | 'mute-and-report' | 'bubble';
export interface RuntimeMetadataManager<TPublic extends AnyJson, TSensitive extends AnyJson> {
    /** Add some public metadata -- this should not contain any PII */
    addPublic: (getData: ProvideMetadata<TPublic>, onError?: MetadataErrorHandling) => Promise<void>;
    /** Add some potentially sensitive metadata -- this may include PII, but unnecessary data should never be tracked (this is a good fit for command args for instance) */
    addSensitive: (getData: ProvideMetadata<TSensitive>, onError?: MetadataErrorHandling) => Promise<void>;
    /** Get a snapshot of the tracked public data */
    getAllPublic: () => Partial<TPublic>;
    /** Get a snapshot of the tracked sensitive data */
    getAllSensitive: () => Partial<TSensitive>;
}
export declare type PublicSchema<T> = T extends RuntimeMetadataManager<infer TPublic, infer _TSensitive> ? TPublic : never;
export declare type SensitiveSchema<T> = T extends RuntimeMetadataManager<infer _TPublic, infer TSensitive> ? TSensitive : never;
/**
 * Creates a container for metadata collected at runtime.
 *
 * The container provides async-safe functions for extracting the gathered metadata, and for setting it.
 *
 */
export declare function createRuntimeMetadataContainer<TPublic extends AnyJson, TSensitive extends AnyJson = {
    [key: string]: never;
}>(): RuntimeMetadataManager<TPublic, TSensitive>;
declare const coreData: RuntimeMetadataManager<PickByPrefix<import("./typing/deep-required.js").DeepRequired<{
    partner_id?: (number | null) | undefined;
    command: string;
    project_type?: (string | null) | undefined;
    time_start: number;
    time_end: number;
    total_time: number;
    success: boolean;
    api_key?: (string | null) | undefined;
    cli_version: string;
    uname: string;
    ruby_version: string;
    node_version: string;
    is_employee: boolean;
    cmd_all_alias_used?: (string | null) | undefined;
    cmd_all_launcher?: (string | null) | undefined;
    cmd_all_path_override?: (boolean | null) | undefined;
    cmd_all_path_override_hash?: (string | null) | undefined;
    cmd_all_plugin?: (string | null) | undefined;
    cmd_all_topic?: (string | null) | undefined;
    cmd_all_verbose?: (boolean | null) | undefined;
    cmd_extensions_binary_from_source?: (boolean | null) | undefined;
    cmd_scaffold_required_auth?: (boolean | null) | undefined;
    cmd_scaffold_template_custom?: (boolean | null) | undefined;
    cmd_scaffold_template_flavor?: (string | null) | undefined;
    cmd_scaffold_type?: (string | null) | undefined;
    cmd_scaffold_type_category?: (string | null) | undefined;
    cmd_scaffold_type_gated?: (boolean | null) | undefined;
    cmd_scaffold_type_owner?: (string | null) | undefined;
    cmd_scaffold_used_prompts_for_type?: (boolean | null) | undefined;
    app_extensions_any?: (boolean | null) | undefined;
    app_extensions_breakdown?: (string | null) | undefined;
    app_extensions_count?: (number | null) | undefined;
    app_extensions_custom_layout?: (boolean | null) | undefined;
    app_extensions_function_any?: (boolean | null) | undefined;
    app_extensions_function_count?: (number | null) | undefined;
    app_extensions_function_custom_layout?: (boolean | null) | undefined;
    app_extensions_theme_any?: (boolean | null) | undefined;
    app_extensions_theme_count?: (number | null) | undefined;
    app_extensions_theme_custom_layout?: (boolean | null) | undefined;
    app_extensions_ui_any?: (boolean | null) | undefined;
    app_extensions_ui_count?: (number | null) | undefined;
    app_extensions_ui_custom_layout?: (boolean | null) | undefined;
    app_name_hash?: (string | null) | undefined;
    app_path_hash?: (string | null) | undefined;
    app_scopes?: (string | null) | undefined;
    app_web_backend_any?: (boolean | null) | undefined;
    app_web_backend_count?: (number | null) | undefined;
    app_web_custom_layout?: (boolean | null) | undefined;
    app_web_frontend_any?: (boolean | null) | undefined;
    app_web_frontend_count?: (number | null) | undefined;
    env_ci?: (boolean | null) | undefined;
    env_ci_platform?: (string | null) | undefined;
    env_plugin_installed_any_custom?: (boolean | null) | undefined;
    env_plugin_installed_shopify?: (string | null) | undefined;
    env_shell?: (string | null) | undefined;
    env_web_ide?: (string | null) | undefined;
}>, "cmd_all_", never>, {
    commandStartOptions: {
        startTime: number;
        startCommand: string;
        startArgs: string[];
    };
}>;
export declare const getAllPublic: () => Partial<PickByPrefix<import("./typing/deep-required.js").DeepRequired<{
    partner_id?: (number | null) | undefined;
    command: string;
    project_type?: (string | null) | undefined;
    time_start: number;
    time_end: number;
    total_time: number;
    success: boolean;
    api_key?: (string | null) | undefined;
    cli_version: string;
    uname: string;
    ruby_version: string;
    node_version: string;
    is_employee: boolean;
    cmd_all_alias_used?: (string | null) | undefined;
    cmd_all_launcher?: (string | null) | undefined;
    cmd_all_path_override?: (boolean | null) | undefined;
    cmd_all_path_override_hash?: (string | null) | undefined;
    cmd_all_plugin?: (string | null) | undefined;
    cmd_all_topic?: (string | null) | undefined;
    cmd_all_verbose?: (boolean | null) | undefined;
    cmd_extensions_binary_from_source?: (boolean | null) | undefined;
    cmd_scaffold_required_auth?: (boolean | null) | undefined;
    cmd_scaffold_template_custom?: (boolean | null) | undefined;
    cmd_scaffold_template_flavor?: (string | null) | undefined;
    cmd_scaffold_type?: (string | null) | undefined;
    cmd_scaffold_type_category?: (string | null) | undefined;
    cmd_scaffold_type_gated?: (boolean | null) | undefined;
    cmd_scaffold_type_owner?: (string | null) | undefined;
    cmd_scaffold_used_prompts_for_type?: (boolean | null) | undefined;
    app_extensions_any?: (boolean | null) | undefined;
    app_extensions_breakdown?: (string | null) | undefined;
    app_extensions_count?: (number | null) | undefined;
    app_extensions_custom_layout?: (boolean | null) | undefined;
    app_extensions_function_any?: (boolean | null) | undefined;
    app_extensions_function_count?: (number | null) | undefined;
    app_extensions_function_custom_layout?: (boolean | null) | undefined;
    app_extensions_theme_any?: (boolean | null) | undefined;
    app_extensions_theme_count?: (number | null) | undefined;
    app_extensions_theme_custom_layout?: (boolean | null) | undefined;
    app_extensions_ui_any?: (boolean | null) | undefined;
    app_extensions_ui_count?: (number | null) | undefined;
    app_extensions_ui_custom_layout?: (boolean | null) | undefined;
    app_name_hash?: (string | null) | undefined;
    app_path_hash?: (string | null) | undefined;
    app_scopes?: (string | null) | undefined;
    app_web_backend_any?: (boolean | null) | undefined;
    app_web_backend_count?: (number | null) | undefined;
    app_web_custom_layout?: (boolean | null) | undefined;
    app_web_frontend_any?: (boolean | null) | undefined;
    app_web_frontend_count?: (number | null) | undefined;
    env_ci?: (boolean | null) | undefined;
    env_ci_platform?: (string | null) | undefined;
    env_plugin_installed_any_custom?: (boolean | null) | undefined;
    env_plugin_installed_shopify?: (string | null) | undefined;
    env_shell?: (string | null) | undefined;
    env_web_ide?: (string | null) | undefined;
}>, "cmd_all_", never>>, getAllSensitive: () => Partial<{
    commandStartOptions: {
        startTime: number;
        startCommand: string;
        startArgs: string[];
    };
}>, addPublic: (getData: ProvideMetadata<PickByPrefix<import("./typing/deep-required.js").DeepRequired<{
    partner_id?: (number | null) | undefined;
    command: string;
    project_type?: (string | null) | undefined;
    time_start: number;
    time_end: number;
    total_time: number;
    success: boolean;
    api_key?: (string | null) | undefined;
    cli_version: string;
    uname: string;
    ruby_version: string;
    node_version: string;
    is_employee: boolean;
    cmd_all_alias_used?: (string | null) | undefined;
    cmd_all_launcher?: (string | null) | undefined;
    cmd_all_path_override?: (boolean | null) | undefined;
    cmd_all_path_override_hash?: (string | null) | undefined;
    cmd_all_plugin?: (string | null) | undefined;
    cmd_all_topic?: (string | null) | undefined;
    cmd_all_verbose?: (boolean | null) | undefined;
    cmd_extensions_binary_from_source?: (boolean | null) | undefined;
    cmd_scaffold_required_auth?: (boolean | null) | undefined;
    cmd_scaffold_template_custom?: (boolean | null) | undefined;
    cmd_scaffold_template_flavor?: (string | null) | undefined;
    cmd_scaffold_type?: (string | null) | undefined;
    cmd_scaffold_type_category?: (string | null) | undefined;
    cmd_scaffold_type_gated?: (boolean | null) | undefined;
    cmd_scaffold_type_owner?: (string | null) | undefined;
    cmd_scaffold_used_prompts_for_type?: (boolean | null) | undefined;
    app_extensions_any?: (boolean | null) | undefined;
    app_extensions_breakdown?: (string | null) | undefined;
    app_extensions_count?: (number | null) | undefined;
    app_extensions_custom_layout?: (boolean | null) | undefined;
    app_extensions_function_any?: (boolean | null) | undefined;
    app_extensions_function_count?: (number | null) | undefined;
    app_extensions_function_custom_layout?: (boolean | null) | undefined;
    app_extensions_theme_any?: (boolean | null) | undefined;
    app_extensions_theme_count?: (number | null) | undefined;
    app_extensions_theme_custom_layout?: (boolean | null) | undefined;
    app_extensions_ui_any?: (boolean | null) | undefined;
    app_extensions_ui_count?: (number | null) | undefined;
    app_extensions_ui_custom_layout?: (boolean | null) | undefined;
    app_name_hash?: (string | null) | undefined;
    app_path_hash?: (string | null) | undefined;
    app_scopes?: (string | null) | undefined;
    app_web_backend_any?: (boolean | null) | undefined;
    app_web_backend_count?: (number | null) | undefined;
    app_web_custom_layout?: (boolean | null) | undefined;
    app_web_frontend_any?: (boolean | null) | undefined;
    app_web_frontend_count?: (number | null) | undefined;
    env_ci?: (boolean | null) | undefined;
    env_ci_platform?: (string | null) | undefined;
    env_plugin_installed_any_custom?: (boolean | null) | undefined;
    env_plugin_installed_shopify?: (string | null) | undefined;
    env_shell?: (string | null) | undefined;
    env_web_ide?: (string | null) | undefined;
}>, "cmd_all_", never>>, onError?: MetadataErrorHandling) => Promise<void>, addSensitive: (getData: ProvideMetadata<{
    commandStartOptions: {
        startTime: number;
        startCommand: string;
        startArgs: string[];
    };
}>, onError?: MetadataErrorHandling) => Promise<void>;
export declare type Public = PublicSchema<typeof coreData>;
export declare type Sensitive = SensitiveSchema<typeof coreData>;
export {};
